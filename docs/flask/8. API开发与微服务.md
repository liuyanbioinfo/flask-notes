# ğŸš€ 8. API å¼€å‘ä¸å¾®æœåŠ¡ 

åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼ŒAPIï¼ˆåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼‰å·²æˆä¸ºç³»ç»Ÿé—´é€šä¿¡çš„æ ¸å¿ƒã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨å¦‚ä½•ä½¿ç”¨Flaskæ„å»ºé«˜è´¨é‡çš„APIï¼Œå¹¶é€æ­¥å‘å¾®æœåŠ¡æ¶æ„æ¼”è¿›ã€‚

## ğŸ“‹ 8.1 RESTful API è®¾è®¡è§„èŒƒ 

### ä»€ä¹ˆæ˜¯RESTful APIï¼Ÿ

RESTï¼ˆRepresentational State Transferï¼‰æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„çº¦æŸæ¡ä»¶å’ŒåŸåˆ™ã€‚RESTful APIéµå¾ªè¿™äº›åŸåˆ™ï¼Œä½¿å¾—APIæ›´åŠ ç›´è§‚ã€å¯é¢„æµ‹å’Œæ˜“äºç»´æŠ¤ã€‚

### RESTæ ¸å¿ƒåŸåˆ™

```mermaid
graph TD
    A[RESTæ ¸å¿ƒåŸåˆ™] --> B[ğŸ¯ ç»Ÿä¸€æ¥å£]
    A --> C[ğŸ“Š æ— çŠ¶æ€]
    A --> D[ğŸ—‚ï¸ å¯ç¼“å­˜]
    A --> E[ğŸ—ï¸ åˆ†å±‚ç³»ç»Ÿ]
    A --> F[ğŸ“ æŒ‰éœ€ä»£ç ]
    A --> G[ğŸ”— å®¢æˆ·ç«¯-æœåŠ¡å™¨]
```

### HTTPæ–¹æ³•ä¸èµ„æºæ“ä½œæ˜ å°„

| HTTPæ–¹æ³• | æ“ä½œ | ç¤ºä¾‹URL | æè¿° |
|---------|------|---------|------|
| GET | è¯»å– | `/api/users` | è·å–ç”¨æˆ·åˆ—è¡¨ |
| GET | è¯»å– | `/api/users/123` | è·å–ç‰¹å®šç”¨æˆ· |
| POST | åˆ›å»º | `/api/users` | åˆ›å»ºæ–°ç”¨æˆ· |
| PUT | æ›´æ–° | `/api/users/123` | å®Œæ•´æ›´æ–°ç”¨æˆ· |
| PATCH | éƒ¨åˆ†æ›´æ–° | `/api/users/123` | éƒ¨åˆ†æ›´æ–°ç”¨æˆ· |
| DELETE | åˆ é™¤ | `/api/users/123` | åˆ é™¤ç”¨æˆ· |

### Flask RESTful API åŸºç¡€ç¤ºä¾‹

```python
# app.py
from flask import Flask, jsonify, request
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///api.db'
db = SQLAlchemy(app)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    email = db.Column(db.String(100), unique=True, nullable=False)

# è·å–æ‰€æœ‰ç”¨æˆ·
@app.route('/api/users', methods=['GET'])
def get_users():
    users = User.query.all()
    return jsonify([
        {'id': user.id, 'name': user.name, 'email': user.email}
        for user in users
    ])

# åˆ›å»ºç”¨æˆ·
@app.route('/api/users', methods=['POST'])
def create_user():
    data = request.get_json()
    user = User(name=data['name'], email=data['email'])
    db.session.add(user)
    db.session.commit()
    return jsonify({'id': user.id, 'name': user.name, 'email': user.email}), 201

# è·å–ç‰¹å®šç”¨æˆ·
@app.route('/api/users/<int:user_id>', methods=['GET'])
def get_user(user_id):
    user = User.query.get_or_404(user_id)
    return jsonify({'id': user.id, 'name': user.name, 'email': user.email})
```

### APIå“åº”æ ¼å¼æ ‡å‡†åŒ–

```python
#utils/response.py
from flask import jsonify

def success_response(data=None, message="Success", status_code=200):
    """æ ‡å‡†åŒ–æˆåŠŸå“åº”"""
    response = {
        'success': True,
        'message': message,
        'data': data
    }
    return jsonify(response), status_code

def error_response(message="Error", status_code=400, errors=None):
    """æ ‡å‡†åŒ–é”™è¯¯å“åº”"""
    response = {
        'success': False,
        'message': message,
        'errors': errors
    }
    return jsonify(response), status_code
```

## ğŸ”„ 8.2 API ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥

### ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼Ÿ

APIç‰ˆæœ¬æ§åˆ¶ç¡®ä¿å‘åå…¼å®¹æ€§ï¼Œå…è®¸å®¢æˆ·ç«¯åœ¨è‡ªå·±çš„èŠ‚å¥ä¸‹è¿ç§»åˆ°æ–°ç‰ˆæœ¬ï¼ŒåŒæ—¶è®©å¼€å‘è€…èƒ½å¤ŸæŒç»­æ”¹è¿›APIã€‚

### ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥å¯¹æ¯”

```mermaid
graph LR
    A[APIç‰ˆæœ¬æ§åˆ¶ç­–ç•¥] --> B[URLè·¯å¾„ç‰ˆæœ¬]
    A --> C[è¯·æ±‚å¤´ç‰ˆæœ¬]
    A --> D[æŸ¥è¯¢å‚æ•°ç‰ˆæœ¬]
    A --> E[å†…å®¹åå•†ç‰ˆæœ¬]
    
    B --> B1["/api/v1/users"]
    C --> C1["Accept: application/vnd.api+json;version=1"]
    D --> D1["/api/users?version=1"]
    E --> E1["Accept: application/json;v=1"]
```

### Flaskç‰ˆæœ¬æ§åˆ¶å®ç°

```python
# app.py
from flask import Flask, Blueprint

app = Flask(__name__)

# æ–¹å¼1: URLè·¯å¾„ç‰ˆæœ¬æ§åˆ¶
api_v1 = Blueprint('api_v1', __name__, url_prefix='/api/v1')
api_v2 = Blueprint('api_v2', __name__, url_prefix='/api/v2')

@api_v1.route('/users')
def get_users_v1():
    return {'version': '1.0', 'users': []}

@api_v2.route('/users')
def get_users_v2():
    return {'version': '2.0', 'users': [], 'pagination': {}}

app.register_blueprint(api_v1)
app.register_blueprint(api_v2)

# æ–¹å¼2: è¯·æ±‚å¤´ç‰ˆæœ¬æ§åˆ¶
@app.route('/api/users')
def get_users():
    version = request.headers.get('API-Version', '1.0')
    if version == '2.0':
        return get_users_v2_logic()
    return get_users_v1_logic()
```

## ğŸ› ï¸ 8.3 Flask-RESTful ä¸ Flask-RESTX

### Flask-RESTfulï¼šç®€æ´çš„REST APIæ¡†æ¶

```python
# api/resources.py
from flask import Flask
from flask_restful import Api, Resource, reqparse

app = Flask(__name__)
api = Api(app)

class UserListAPI(Resource):
    def __init__(self):
        self.reqparse = reqparse.RequestParser()
        self.reqparse.add_argument('name', type=str, required=True, location='json')
        self.reqparse.add_argument('email', type=str, required=True, location='json')
        super(UserListAPI, self).__init__()
    
    def get(self):
        """è·å–ç”¨æˆ·åˆ—è¡¨"""
        return {'users': []}
    
    def post(self):
        """åˆ›å»ºæ–°ç”¨æˆ·"""
        args = self.reqparse.parse_args()
        # åˆ›å»ºç”¨æˆ·é€»è¾‘
        return {'message': 'User created', 'user': args}, 201

api.add_resource(UserListAPI, '/api/users')
```

### Flask-RESTXï¼šå¸¦æ–‡æ¡£ç”Ÿæˆçš„å¢å¼ºç‰ˆ

```python
# api/namespaces.py
from flask import Flask
from flask_restx import Api, Resource, fields, Namespace

app = Flask(__name__)
api = Api(app, doc='/docs/', title='ç”¨æˆ·ç®¡ç†API', description='ç”¨æˆ·ç®¡ç†ç³»ç»ŸAPIæ–‡æ¡£')

# åˆ›å»ºå‘½åç©ºé—´
user_ns = Namespace('users', description='ç”¨æˆ·ç›¸å…³æ“ä½œ')

# å®šä¹‰æ•°æ®æ¨¡å‹
user_model = user_ns.model('User', {
    'id': fields.Integer(required=True, description='ç”¨æˆ·ID'),
    'name': fields.String(required=True, description='ç”¨æˆ·å§“å'),
    'email': fields.String(required=True, description='ç”¨æˆ·é‚®ç®±')
})

user_input_model = user_ns.model('UserInput', {
    'name': fields.String(required=True, description='ç”¨æˆ·å§“å'),
    'email': fields.String(required=True, description='ç”¨æˆ·é‚®ç®±')
})

@user_ns.route('/')
class UserList(Resource):
    @user_ns.marshal_list_with(user_model)
    @user_ns.doc('è·å–ç”¨æˆ·åˆ—è¡¨')
    def get(self):
        """è·å–æ‰€æœ‰ç”¨æˆ·"""
        return []
    
    @user_ns.expect(user_input_model)
    @user_ns.marshal_with(user_model, code=201)
    @user_ns.doc('åˆ›å»ºç”¨æˆ·')
    def post(self):
        """åˆ›å»ºæ–°ç”¨æˆ·"""
        return {}, 201

api.add_namespace(user_ns, path='/api/users')
```

## ğŸ”— 8.4 GraphQL API å¼€å‘

### GraphQL vs RESTå¯¹æ¯”

```mermaid
graph TB
    subgraph REST["REST API"]
        R1["GET /users"]
        R2["GET /users/1/posts"]
        R3["GET /posts/1/comments"]
    end
    
    subgraph GraphQL["GraphQL API"]
        G1["å•ä¸€ç«¯ç‚¹ /graphql"]
        G2["æŸ¥è¯¢è¯­è¨€"]
        G3["ç²¾ç¡®æ•°æ®è·å–"]
    end
    
    REST --> |å¤šæ¬¡è¯·æ±‚| Result1["å¤šä¸ªHTTPè¯·æ±‚"]
    GraphQL --> |å•æ¬¡è¯·æ±‚| Result2["ä¸€æ¬¡HTTPè¯·æ±‚"]
```

### Flask + Graphene å®ç°

```python
# graphql_api.py
from flask import Flask
from flask_graphql import GraphQLView
import graphene
from graphene_sqlalchemy import SQLAlchemyObjectType

app = Flask(__name__)

# GraphQLç±»å‹å®šä¹‰
class UserType(SQLAlchemyObjectType):
    class Meta:
        model = User
        interfaces = (graphene.relay.Node,)

# æŸ¥è¯¢ç±»
class Query(graphene.ObjectType):
    users = graphene.List(UserType)
    user = graphene.Field(UserType, id=graphene.Int())
    
    def resolve_users(self, info):
        return User.query.all()
    
    def resolve_user(self, info, id):
        return User.query.get(id)

# å˜æ›´ç±»
class CreateUser(graphene.Mutation):
    class Arguments:
        name = graphene.String(required=True)
        email = graphene.String(required=True)
    
    user = graphene.Field(UserType)
    
    def mutate(self, info, name, email):
        user = User(name=name, email=email)
        db.session.add(user)
        db.session.commit()
        return CreateUser(user=user)

class Mutation(graphene.ObjectType):
    create_user = CreateUser.Field()

# åˆ›å»ºSchema
schema = graphene.Schema(query=Query, mutation=Mutation)

# æ·»åŠ GraphQLç«¯ç‚¹
app.add_url_rule('/graphql', view_func=GraphQLView.as_view(
    'graphql',
    schema=schema,
    graphiql=True  # å¯ç”¨GraphiQLç•Œé¢
))
```

## ğŸ“š 8.5 API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼ˆSwagger/OpenAPIï¼‰

### OpenAPIè§„èŒƒçš„é‡è¦æ€§

OpenAPIï¼ˆåŸSwaggerï¼‰è§„èŒƒæä¾›äº†æè¿°REST APIçš„æ ‡å‡†æ–¹å¼ï¼Œä½¿å¾—APIæ–‡æ¡£åŒ–ã€æµ‹è¯•å’Œå®¢æˆ·ç«¯ä»£ç ç”Ÿæˆå˜å¾—è‡ªåŠ¨åŒ–ã€‚

### Flask-RESTXè‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ

```python
# api/swagger_config.py
from flask import Flask
from flask_restx import Api, Resource, fields

app = Flask(__name__)

# é…ç½®Swaggeræ–‡æ¡£
api = Api(
    app,
    version='1.0',
    title='åšå®¢API',
    description='ä¸€ä¸ªç®€å•çš„åšå®¢ç®¡ç†API',
    doc='/docs/',
    authorizations={
        'Bearer': {
            'type': 'apiKey',
            'in': 'header',
            'name': 'Authorization',
            'description': 'JWT Token: Bearer <token>'
        }
    },
    security='Bearer'
)

# å®šä¹‰é”™è¯¯å“åº”æ¨¡å‹
error_model = api.model('Error', {
    'message': fields.String(description='é”™è¯¯ä¿¡æ¯'),
    'code': fields.Integer(description='é”™è¯¯ä»£ç ')
})

# å®šä¹‰åˆ†é¡µæ¨¡å‹
pagination_model = api.model('Pagination', {
    'page': fields.Integer(description='å½“å‰é¡µç '),
    'per_page': fields.Integer(description='æ¯é¡µæ•°é‡'),
    'total': fields.Integer(description='æ€»æ•°é‡'),
    'pages': fields.Integer(description='æ€»é¡µæ•°')
})

@api.route('/users')
class UserListResource(Resource):
    @api.doc('è·å–ç”¨æˆ·åˆ—è¡¨')
    @api.param('page', 'é¡µç ', type='integer', default=1)
    @api.param('per_page', 'æ¯é¡µæ•°é‡', type='integer', default=10)
    @api.response(200, 'æˆåŠŸ', user_list_model)
    @api.response(400, 'è¯·æ±‚é”™è¯¯', error_model)
    def get(self):
        """è·å–ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µ"""
        pass
```

## ğŸ›¡ï¸ 8.6 API é™æµä¸ç†”æ–­æœºåˆ¶

### é™æµç­–ç•¥

```mermaid
graph TD
    A[APIé™æµç­–ç•¥] --> B[å›ºå®šçª—å£]
    A --> C[æ»‘åŠ¨çª—å£]
    A --> D[ä»¤ç‰Œæ¡¶]
    A --> E[æ¼æ¡¶ç®—æ³•]
    
    B --> B1["ç®€å•è®¡æ•°"]
    C --> C1["ç²¾ç¡®æ§åˆ¶"]
    D --> D1["çªå‘å¤„ç†"]
    E --> E1["å¹³æ»‘é™æµ"]
```

### Flask-Limiterå®ç°

```python
# api/rate_limiting.py
from flask import Flask, jsonify
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address
import redis

app = Flask(__name__)

# é…ç½®Redisä½œä¸ºå­˜å‚¨åç«¯
limiter = Limiter(
    app,
    key_func=get_remote_address,
    storage_uri="redis://localhost:6379",
    default_limits=["1000 per hour"]
)

@app.route('/api/users')
@limiter.limit("10 per minute")  # æ¯åˆ†é’Ÿæœ€å¤š10æ¬¡è¯·æ±‚
def get_users():
    return jsonify({'users': []})

@app.route('/api/upload')
@limiter.limit("5 per hour")  # ä¸Šä¼ æ¥å£æ›´ä¸¥æ ¼çš„é™åˆ¶
def upload_file():
    return jsonify({'message': 'File uploaded'})

# è‡ªå®šä¹‰é™æµé”®å‡½æ•°
def get_user_id():
    # åŸºäºç”¨æˆ·IDè¿›è¡Œé™æµ
    return request.headers.get('User-ID', get_remote_address())

@app.route('/api/premium')
@limiter.limit("100 per hour", key_func=get_user_id)
def premium_api():
    return jsonify({'data': 'premium content'})

# é™æµå¼‚å¸¸å¤„ç†
@app.errorhandler(429)
def ratelimit_handler(e):
    return jsonify({
        'error': 'Rate limit exceeded',
        'message': str(e.description),
        'retry_after': e.retry_after
    }), 429
```

### ç†”æ–­å™¨æ¨¡å¼å®ç°

```python
# utils/circuit_breaker.py
import time
from enum import Enum
from functools import wraps

class CircuitState(Enum):
    CLOSED = "closed"      # æ­£å¸¸çŠ¶æ€
    OPEN = "open"          # ç†”æ–­çŠ¶æ€
    HALF_OPEN = "half_open" # åŠå¼€çŠ¶æ€

class CircuitBreaker:
    def __init__(self, failure_threshold=5, timeout=60):
        self.failure_threshold = failure_threshold
        self.timeout = timeout
        self.failure_count = 0
        self.last_failure_time = None
        self.state = CircuitState.CLOSED
    
    def call(self, func, *args, **kwargs):
        if self.state == CircuitState.OPEN:
            if time.time() - self.last_failure_time > self.timeout:
                self.state = CircuitState.HALF_OPEN
            else:
                raise Exception("Circuit breaker is OPEN")
        
        try:
            result = func(*args, **kwargs)
            self.on_success()
            return result
        except Exception as e:
            self.on_failure()
            raise e
    
    def on_success(self):
        self.failure_count = 0
        self.state = CircuitState.CLOSED
    
    def on_failure(self):
        self.failure_count += 1
        self.last_failure_time = time.time()
        if self.failure_count >= self.failure_threshold:
            self.state = CircuitState.OPEN

# è£…é¥°å™¨ä½¿ç”¨
def circuit_breaker(failure_threshold=5, timeout=60):
    cb = CircuitBreaker(failure_threshold, timeout)
    
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            return cb.call(func, *args, **kwargs)
        return wrapper
    return decorator

# ä½¿ç”¨ç¤ºä¾‹
@circuit_breaker(failure_threshold=3, timeout=30)
def external_api_call():
    # è°ƒç”¨å¤–éƒ¨API
    pass
```

## ğŸ—ï¸ 8.7 å¾®æœåŠ¡æ¶æ„è®¾è®¡

### å•ä½“æ¶æ„ vs å¾®æœåŠ¡æ¶æ„

```mermaid
graph TB
    subgraph Monolith["å•ä½“æ¶æ„"]
        M1["Webå±‚"]
        M2["ä¸šåŠ¡é€»è¾‘å±‚"]
        M3["æ•°æ®è®¿é—®å±‚"]
        M4["æ•°æ®åº“"]
        M1 --> M2
        M2 --> M3
        M3 --> M4
    end
    
    subgraph Microservices["å¾®æœåŠ¡æ¶æ„"]
        direction TB
        subgraph Gateway["APIç½‘å…³"]
            G1["è·¯ç”±"]
            G2["è®¤è¯"]
            G3["é™æµ"]
        end
        
        subgraph Services["å¾®æœåŠ¡"]
            S1["ç”¨æˆ·æœåŠ¡"]
            S2["è®¢å•æœåŠ¡"]
            S3["æ”¯ä»˜æœåŠ¡"]
            S4["é€šçŸ¥æœåŠ¡"]
        end
        
        subgraph Data["æ•°æ®å±‚"]
            D1["ç”¨æˆ·DB"]
            D2["è®¢å•DB"]
            D3["æ”¯ä»˜DB"]
        end
        
        Gateway --> Services
        S1 --> D1
        S2 --> D2
        S3 --> D3
    end
```

### Flaskå¾®æœåŠ¡åŸºç¡€æ¶æ„

```python
# services/user_service.py
from flask import Flask, jsonify, request
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate
import os

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = os.getenv('DATABASE_URL', 'sqlite:///users.db')
db = SQLAlchemy(app)
migrate = Migrate(app, db)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)

@app.route('/health')
def health_check():
    """å¥åº·æ£€æŸ¥ç«¯ç‚¹"""
    return jsonify({'status': 'healthy', 'service': 'user-service'})

@app.route('/users', methods=['GET'])
def get_users():
    users = User.query.all()
    return jsonify([
        {'id': u.id, 'username': u.username, 'email': u.email}
        for u in users
    ])

@app.route('/users', methods=['POST'])
def create_user():
    data = request.get_json()
    user = User(username=data['username'], email=data['email'])
    db.session.add(user)
    db.session.commit()
    return jsonify({'id': user.id, 'username': user.username}), 201

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5001)
```

### æœåŠ¡é—´é€šä¿¡

```python
# utils/service_client.py
import requests
import json
from typing import Optional, Dict, Any

class ServiceClient:
    def __init__(self, base_url: str, timeout: int = 30):
        self.base_url = base_url.rstrip('/')
        self.timeout = timeout
        self.session = requests.Session()
    
    def get(self, endpoint: str, params: Optional[Dict] = None) -> Dict[str, Any]:
        """GETè¯·æ±‚"""
        url = f"{self.base_url}/{endpoint.lstrip('/')}"
        response = self.session.get(url, params=params, timeout=self.timeout)
        response.raise_for_status()
        return response.json()
    
    def post(self, endpoint: str, data: Dict[str, Any]) -> Dict[str, Any]:
        """POSTè¯·æ±‚"""
        url = f"{self.base_url}/{endpoint.lstrip('/')}"
        response = self.session.post(
            url, 
            json=data, 
            timeout=self.timeout,
            headers={'Content-Type': 'application/json'}
        )
        response.raise_for_status()
        return response.json()

# ä½¿ç”¨ç¤ºä¾‹
user_service = ServiceClient('http://user-service:5001')
order_service = ServiceClient('http://order-service:5002')

@app.route('/user-orders/<int:user_id>')
def get_user_orders(user_id):
    try:
        # è°ƒç”¨ç”¨æˆ·æœåŠ¡è·å–ç”¨æˆ·ä¿¡æ¯
        user = user_service.get(f'/users/{user_id}')
        # è°ƒç”¨è®¢å•æœåŠ¡è·å–ç”¨æˆ·è®¢å•
        orders = order_service.get('/orders', params={'user_id': user_id})
        
        return jsonify({
            'user': user,
            'orders': orders
        })
    except requests.RequestException as e:
        return jsonify({'error': 'Service unavailable'}), 503
```

### Dockerå®¹å™¨åŒ–éƒ¨ç½²

```dockerfile
# Dockerfile
FROM python:3.9-slim

WORKDIR /app

# å®‰è£…ä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 5000

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:5000/health || exit 1

# å¯åŠ¨åº”ç”¨
CMD ["gunicorn", "--bind", "0.0.0.0:5000", "--workers", "4", "app:app"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  user-service:
    build: ./user-service
    ports:
      - "5001:5000"
    environment:
      - DATABASE_URL=postgresql://user:pass@user-db:5432/users
    depends_on:
      - user-db
    networks:
      - microservices
  
  order-service:
    build: ./order-service
    ports:
      - "5002:5000"
    environment:
      - DATABASE_URL=postgresql://user:pass@order-db:5432/orders
    depends_on:
      - order-db
    networks:
      - microservices
  
  api-gateway:
    build: ./api-gateway
    ports:
      - "8080:5000"
    environment:
      - USER_SERVICE_URL=http://user-service:5000
      - ORDER_SERVICE_URL=http://order-service:5000
    depends_on:
      - user-service
      - order-service
    networks:
      - microservices
  
  user-db:
    image: postgres:13
    environment:
      - POSTGRES_DB=users
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
    networks:
      - microservices
  
  order-db:
    image: postgres:13
    environment:
      - POSTGRES_DB=orders
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
    networks:
      - microservices

networks:
  microservices:
    driver: bridge
```

## ğŸ“ æ€»ç»“

æœ¬ç« æ·±å…¥æ¢è®¨äº†Flask APIå¼€å‘çš„å„ä¸ªæ–¹é¢ï¼Œä»åŸºç¡€çš„RESTfulè®¾è®¡åˆ°å¤æ‚çš„å¾®æœåŠ¡æ¶æ„ã€‚å…³é”®è¦ç‚¹åŒ…æ‹¬ï¼š

- **RESTfulè®¾è®¡**ï¼šéµå¾ªRESTåŸåˆ™ï¼Œä½¿ç”¨æ ‡å‡†HTTPæ–¹æ³•å’ŒçŠ¶æ€ç 
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šä¸ºAPIæ¼”è¿›æä¾›å‘åå…¼å®¹æ€§ä¿éšœ
- **å·¥å…·é€‰æ‹©**ï¼šFlask-RESTfulé€‚åˆç®€å•APIï¼ŒFlask-RESTXæä¾›æ–‡æ¡£ç”Ÿæˆ
- **GraphQL**ï¼šä¸ºå¤æ‚æ•°æ®æŸ¥è¯¢æä¾›æ›´çµæ´»çš„è§£å†³æ–¹æ¡ˆ
- **æ–‡æ¡£åŒ–**ï¼šè‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£æé«˜å¼€å‘æ•ˆç‡
- **ä¿æŠ¤æœºåˆ¶**ï¼šé™æµå’Œç†”æ–­ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§
- **å¾®æœåŠ¡**ï¼šåˆç†æ‹†åˆ†æœåŠ¡ï¼Œæ³¨æ„æœåŠ¡é—´é€šä¿¡å’Œæ•°æ®ä¸€è‡´æ€§

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨åº”ç”¨æ¶æ„ä¸æ¨¡å—åŒ–è®¾è®¡ï¼Œå­¦ä¹ å¦‚ä½•æ„å»ºå¯ç»´æŠ¤å’Œå¯æ‰©å±•çš„Flaskåº”ç”¨ã€‚
        